<!DOCTYPE html>
<html>
  <head>
    <title>right.html</title>
	
    <meta name="keywords" content="keyword1,keyword2,keyword3">
    <meta name="description" content="this is my page">
    <meta name="content-type" content="text/html; charset=UTF-8">
    
    <!--<link rel="stylesheet" type="text/css" href="./styles.css">-->

  </head>
  <script src="./js/jquery.js"></script>
  <script type="text/javascript">
    
    function queryValueByKey(queryKey)
    {
  
      var redisdb = $('#redisdb').val();
    
      $.ajax({
			type: "post",
			url: "/gradvenRedis/servlet/redisservlet?type=2&redisdb=" + redisdb +"&querykey=" + queryKey,
			timeout : 3000 ,	
			success: function(data){
			   
			   
			   $("#singleKey").html(queryKey); 
			   $("#retValue").html("");
			   
			   var dataArray = eval(data);  
				for(i in dataArray)  
				{  				   
				   $("#retValue").append(dataArray[i]);  
				   $("#retValue").append("\r\n");
				
				}  	
				
				 //$("#retValue").html(data); 	   		    
                  
       			
			},	
			error: function()
			{				
			  alert("error!");
						
			}
		});
       
    }
  
    function queryKeysByStr()
	{
	    var redisdb = $('#redisdb').val();
	
	    var querykey = $('#querykey').val();
	    
	    var count = $('#count').val();
	    
	    
	    if (querykey == "")
	    {
	       alert("key can't is empty!");
	       return;
	    }
	
   		$.ajax({
			type: "post",
			url: "/gradvenRedis/servlet/redisservlet?type=3&redisdb=" + redisdb +"&querykey=" + querykey + "&count=" + count,
			timeout : 3000 ,	
			dataType : 'json',
			success: function(data){
			
			$("#retcount").html(eval(data).length);
			
			$("#project tr:not(#title)").remove(); 

			   var tbody = ""; 	
			   
			   if (data == "")
			   {
			     var trs = "";
			     trs += " <tr> <td colspan=3 style=\"text-align:center\"> There is none data!!! </td> <tr>";
			     tbody += trs;
			   }
			   
			   		   
			   $.each(data, function(n, item) {  
                    var trs = "";  
                    trs += " <tr> <td> <a href=\"#\" onclick=queryValueByKey('"+item.key+"')>" + item.key +"</a> </td> <td>" + item.keyType +" </td><td>" + item.keySize +"</td> </tr>";  
                    tbody += trs;    
                         
                });  
                
             // $("#retcount").html(data); 
  
              $("#project").append(tbody);  
       			
			},	
			error: function()
			{				
			  alert("error!");
						
			}
		});
	}
  
  
  function hideCount()
  {
     var target=document.getElementById("showcount");
     target.style.display="none";
  }
  
  function showCount()
  {
     var target=document.getElementById("showcount");
     target.style.display="block";
  }
  </script>
  
  <body>
    Read Data<br/>
    <hr>
    <div style="background:#E0E0E0; color:black">
    <br/>
    <form>
    &nbsp;&nbsp;KEY:<input type="text" size=50 name="querykey" id=querykey />
    <select id=redisdb>
    <option value="0">db0</option>
    <option value="1">db1</option>
    <option value="2">db2</option>
    <option value="3">db3</option>
    <option value="4">db4</option>
    <option value="5">db5</option>
    <option value="6">db6</option>
    <option value="7">db7</option>
    <option value="8">db8</option>
    <option value="9">db9</option>
    <option value="10">db10</option>
    <option value="11">db11</option>
    <option value="12">db12</option>
    <option value="13">db13</option>
    <option value="14">db14</option>
    <option value="15">db15</option>
    </select>
    
    
    Count Limit:<input type="text" name="count" id=count value="10" size=5 />

    &nbsp;
    <input type="button" name="submitkey" value="submit" onClick="queryKeysByStr()"/>
    </form>
    <div> &nbsp;&nbsp;Accept Java-compatible Regex</div>   
    <br/>
     </div>
     Result count: <span id=retcount></span>  
     <table>
         <tr>
            <td>
		     <table id ="project"  border="1" > 
		     <tr id="title" style="background:#E0E0E0; color:black"> 
		     <th style="width:200px"> name </th> <th style="width:100px">type</th> <th  style="width:100px">size</th>  
		     </tr>     
		     </table> 
		    </td>
	     <td>
	    	 key: &nbsp;&nbsp;
	    	 <textarea id="singleKey" rows="1" cols="50"></textarea>
	    	 <br/>
	    	 <br/>
	    	 value:&nbsp;<textarea id="retValue" rows="5" cols="50"></textarea>
	     </td>
	     </tr>
     
     </table>
    
     
  </body>
</html>
